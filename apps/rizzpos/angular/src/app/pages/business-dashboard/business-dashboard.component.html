<rizzpos-header [title]="(businessData$ | async)?.businessName || 'Business Dashboard'"></rizzpos-header>

<ion-content class="ion-padding">
  <ng-container *ngIf="isLoading; else dashboardContent">
    <ion-skeleton-text animated style="width: 60%"></ion-skeleton-text>
    <ion-skeleton-text animated style="width: 80%"></ion-skeleton-text>
    <ion-skeleton-text animated style="width: 70%"></ion-skeleton-text>
  </ng-container>

  <ng-template #dashboardContent>
    <ion-grid>
      <ion-row>
        <ion-col size="12" size-md="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Business Overview</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ng-container *ngIf="businessData$ | async as businessData">
                <p><strong>Name:</strong> {{ businessData.businessName }}</p>
                <p><strong>Type:</strong> {{ businessData.businessType }}</p>
                <p><strong>Address:</strong> {{ businessData.address }}</p>
                <p><strong>Phone:</strong> {{ businessData.phoneNumber }}</p>
              </ng-container>
            </ion-card-content>
          </ion-card>
        </ion-col>
        <ion-col size="12" size-md="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Sales Summary</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <p><strong>Today's Sales:</strong> {{ todaySales | currency }}</p>
              <p><strong>This Month's Sales:</strong> {{ monthSales | currency }}</p>
              <p><strong>Total Products:</strong> {{ totalProducts }}</p>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col size="12">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Quick Actions</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-grid>
                <ion-row>
                  <ion-col size="6" size-md="3" *ngFor="let action of quickActions">
                    <ion-button (click)="navigateTo(action.route)" expand="block" fill="outline"
                      class="ion-margin-bottom">
                      <ion-icon slot="start" [name]="action.icon"></ion-icon>
                      {{ action.label }}
                    </ion-button>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col size="12" size-md="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Recent Transactions</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-list>
                <ion-item *ngFor="let transaction of recentTransactions$ | async">
                  <ion-label>
                    <h2>{{ transaction.id }}</h2>
                    <p>{{ transaction.date | date:'short' }}</p>
                    <p>Total: {{ transaction.total | currency }}</p>
                  </ion-label>
                </ion-item>
              </ion-list>
            </ion-card-content>
          </ion-card>
        </ion-col>
        <ion-col size="12" size-md="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Low Stock Alerts</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-list>
                <ion-item *ngFor="let product of lowStockProducts$ | async">
                  <ion-label>
                    <h2>{{ product.name }}</h2>
                    <p>Current Stock: {{ product.stockQuantity }}</p>
                  </ion-label>
                  <ion-badge slot="end" color="danger">Low Stock</ion-badge>
                </ion-item>
              </ion-list>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col size="12" size-md="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Add Staff</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-button expand="block" (click)="copyURL('cashier')">Add Cashier</ion-button>
              <ion-button expand="block" (click)="copyURL('manager')">Add Manager</ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>
        <ion-col size="12" size-md="6">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Customer URL</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-button expand="block" (click)="copyURL('customer')">Copy Customer URL</ion-button>
            </ion-card-content>
          </ion-card>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ng-template>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-title size="small">Â© {{ currentYear }} {{ (businessData$ | async)?.businessName }}</ion-title>
  </ion-toolbar>
</ion-footer>

<rizzpos-footer></rizzpos-footer>